<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ÙÙŠ Ø¹Ø¬Ù„Ø© Ø§Ù„Ø­Ø¸</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
  
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;800&display=swap" rel="stylesheet">
  <!-- Font Awesome for Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

  <style>
    :root {
      --primary: #ff2b2b;
      --primary-light: #ff5c5c;
      --primary-dark: #cc0000;
      --secondary: #00c9ff;
      --secondary-light: #6ee7ff;
      --dark: #0a0a0a;
      --darker: #050505;
      --light: #ffffff;
      --gray: #333333;
      --gray-light: #444444;
      --success: #00ff88;
      --warning: #ffaa00;
      --error: #ff3333;
      --gold: #ffd700;
      --silver: #c0c0c0;
      --bronze: #cd7f32;
      
      /* Responsive Breakpoints */
      --mobile: 480px;
      --tablet: 768px;
      --desktop: 1024px;
      --large-desktop: 1200px;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Cairo', sans-serif;
    }
    
    html {
      font-size: 16px;
      -webkit-text-size-adjust: 100%;
    }
    
    body {
      min-height: 100vh;
      min-height: -webkit-fill-available;
      display: flex;
      align-items: center;
      justify-content: center;
      background: radial-gradient(ellipse at top, var(--darker) 0%, var(--dark) 70%);
      color: var(--light);
      overflow-x: hidden;
      padding: 16px;
      position: relative;
    }
    
    /* Improved Mobile Support */
    @supports (-webkit-touch-callout: none) {
      body {
        min-height: -webkit-fill-available;
      }
    }
    
    /* Animated Background Elements */
    .bg-particle {
      position: absolute;
      border-radius: 50%;
      background: rgba(255, 43, 43, 0.1);
      z-index: -1;
    }
    
    .wheel-bg {
      position: absolute;
      width: min(300px, 80vw);
      height: min(300px, 80vw);
      border-radius: 50%;
      border: 2px dashed rgba(255, 43, 43, 0.2);
      z-index: -1;
      animation: rotate 120s linear infinite;
    }
    
    .wheel-bg:nth-child(2) {
      width: min(500px, 90vw);
      height: min(500px, 90vw);
      border-color: rgba(0, 201, 255, 0.15);
      animation-duration: 180s;
    }
    
    @keyframes rotate {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    
    /* Card Styles - Fully Responsive */
    .card {
      width: 100%;
      max-width: 500px;
      min-width: 280px;
      background: rgba(15, 15, 15, 0.95);
      border: 2px solid var(--primary);
      border-radius: 20px;
      padding: clamp(20px, 5vw, 30px);
      box-shadow: 
        0 10px 40px rgba(255, 43, 43, 0.25),
        0 0 80px rgba(0, 201, 255, 0.15),
        inset 0 0 20px rgba(255, 43, 43, 0.1);
      backdrop-filter: blur(10px);
      position: relative;
      overflow: hidden;
      z-index: 1;
      animation: fadeIn 0.8s ease-out;
    }
    
    /* Responsive Card Sizes */
    @media (max-width: 480px) {
      .card {
        border-radius: 18px;
        padding: 18px;
        max-width: 100%;
      }
    }
    
    @media (min-width: 481px) and (max-width: 767px) {
      .card {
        max-width: 450px;
      }
    }
    
    @media (min-width: 768px) and (max-width: 1023px) {
      .card {
        max-width: 480px;
      }
    }
    
    @media (min-width: 1024px) {
      .card {
        max-width: 500px;
      }
    }
    
    @media (min-width: 1200px) {
      .card {
        max-width: 520px;
      }
    }
    
    .card::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255, 43, 43, 0.05) 0%, transparent 70%);
      z-index: -1;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    /* Header Styles */
    .header {
      text-align: center;
      margin-bottom: clamp(20px, 4vw, 25px);
      position: relative;
    }
    
    .title-icon {
      display: inline-block;
      font-size: clamp(36px, 8vw, 42px);
      color: var(--gold);
      margin-bottom: clamp(8px, 2vw, 10px);
      animation: pulse 2s infinite alternate;
    }
    
    @keyframes pulse {
      0% { transform: scale(1); }
      100% { transform: scale(1.1); }
    }
    
    h1 {
      font-size: clamp(22px, 5vw, 28px);
      font-weight: 800;
      margin: 0 0 clamp(4px, 1vw, 5px) 0;
      background: linear-gradient(90deg, var(--primary), var(--secondary));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      text-shadow: 0 2px 10px rgba(255, 43, 43, 0.3);
      line-height: 1.3;
    }
    
    .subtitle {
      font-size: clamp(14px, 3.5vw, 16px);
      color: #aaa;
      margin-bottom: clamp(8px, 2vw, 10px);
      line-height: 1.4;
    }
    
    /* Counter Styles */
    .counter-container {
      background: rgba(10, 10, 10, 0.9);
      border-radius: clamp(14px, 3vw, 16px);
      padding: clamp(12px, 3vw, 15px);
      margin-bottom: clamp(24px, 5vw, 30px);
      text-align: center;
      border: 1px solid var(--gray-light);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
      position: relative;
      overflow: hidden;
    }
    
    .counter-container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 4px;
      background: linear-gradient(90deg, var(--primary), var(--secondary));
    }
    
    .counter-label {
      font-size: clamp(14px, 3.5vw, 16px);
      font-weight: 600;
      color: #aaa;
      margin-bottom: clamp(6px, 1.5vw, 8px);
    }
    
    .counter-value {
      font-size: clamp(32px, 8vw, 42px);
      font-weight: 800;
      color: var(--gold);
      text-shadow: 0 0 15px rgba(255, 215, 0, 0.7);
      transition: all 0.3s ease;
      line-height: 1.2;
      word-break: break-word;
      overflow-wrap: break-word;
    }
    
    .counter-badge {
      display: inline-block;
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      color: white;
      font-size: clamp(12px, 3vw, 14px);
      padding: clamp(4px, 1vw, 5px) clamp(10px, 2.5vw, 12px);
      border-radius: 20px;
      margin-top: clamp(8px, 2vw, 10px);
      font-weight: 600;
      box-shadow: 0 4px 8px rgba(255, 43, 43, 0.3);
    }
    
    /* Form Styles */
    .form-group {
      margin-bottom: clamp(18px, 4vw, 22px);
      position: relative;
    }
    
    label {
      display: block;
      margin-bottom: clamp(6px, 1.5vw, 8px);
      font-size: clamp(14px, 3.5vw, 16px);
      font-weight: 600;
      color: #ddd;
      padding-right: 10px;
    }
    
    label i {
      margin-left: clamp(6px, 1.5vw, 8px);
      color: var(--primary-light);
      font-size: clamp(14px, 3.5vw, 16px);
    }
    
    .input-container {
      position: relative;
    }
    
    input {
      width: 100%;
      padding: clamp(14px, 3.5vw, 16px) clamp(18px, 4vw, 20px) clamp(14px, 3.5vw, 16px) 50px;
      border-radius: clamp(12px, 3vw, 14px);
      border: 2px solid var(--gray);
      background: rgba(10, 10, 10, 0.9);
      color: var(--light);
      font-size: clamp(14px, 3.5vw, 16px);
      transition: all 0.3s ease;
      direction: ltr;
      min-height: 50px;
    }
    
    input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(255, 43, 43, 0.2);
      background: rgba(20, 20, 20, 0.95);
    }
    
    /* Prevent zoom on iOS input focus */
    @media (max-width: 480px) {
      input {
        font-size: 16px; /* Prevents iOS zoom */
      }
    }
    
    .input-icon {
      position: absolute;
      left: clamp(15px, 3.5vw, 18px);
      top: 50%;
      transform: translateY(-50%);
      color: var(--primary);
      font-size: clamp(16px, 4vw, 18px);
      z-index: 2;
    }
    
    /* Button Styles */
    .btn-container {
      margin-top: clamp(24px, 5vw, 30px);
      position: relative;
    }
    
    button {
      width: 100%;
      padding: clamp(16px, 4vw, 18px);
      border: none;
      border-radius: clamp(14px, 3.5vw, 16px);
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      color: var(--light);
      font-size: clamp(16px, 4vw, 18px);
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      box-shadow: 0 8px 20px rgba(255, 43, 43, 0.4);
      min-height: 55px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }
    
    button:hover:not(:disabled) {
      transform: translateY(-3px);
      box-shadow: 0 12px 25px rgba(255, 43, 43, 0.6);
    }
    
    button:active:not(:disabled) {
      transform: translateY(0);
    }
    
    button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }
    
    .btn-glow {
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.7s;
    }
    
    button:hover:not(:disabled) .btn-glow {
      left: 100%;
    }
    
    /* Message Styles */
    .message {
      text-align: center;
      margin-top: clamp(16px, 4vw, 20px);
      padding: clamp(12px, 3vw, 15px);
      border-radius: clamp(10px, 2.5vw, 12px);
      font-size: clamp(14px, 3.5vw, 16px);
      font-weight: 600;
      opacity: 0;
      transform: translateY(10px);
      transition: all 0.4s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-wrap: wrap;
      gap: 8px;
      min-height: 60px;
    }
    
    .message i {
      font-size: clamp(18px, 4.5vw, 20px);
      flex-shrink: 0;
    }
    
    .message.show {
      opacity: 1;
      transform: translateY(0);
    }
    
    .message.success {
      background: rgba(0, 255, 136, 0.1);
      color: var(--success);
      border: 1px solid rgba(0, 255, 136, 0.3);
    }
    
    .message.warning {
      background: rgba(255, 170, 0, 0.1);
      color: var(--warning);
      border: 1px solid rgba(255, 170, 0, 0.3);
    }
    
    .message.error {
      background: rgba(255, 51, 51, 0.1);
      color: var(--error);
      border: 1px solid rgba(255, 51, 51, 0.3);
    }
    
    /* Footer */
    .footer {
      text-align: center;
      margin-top: clamp(20px, 4vw, 25px);
      font-size: clamp(12px, 3vw, 14px);
      color: #777;
      padding-top: clamp(12px, 3vw, 15px);
      border-top: 1px solid rgba(255, 255, 255, 0.05);
      line-height: 1.5;
    }
    
    /* Landscape Orientation Support */
    @media (orientation: landscape) and (max-height: 600px) {
      body {
        padding: 10px;
        align-items: flex-start;
      }
      
      .card {
        margin-top: 10px;
        max-height: 90vh;
        overflow-y: auto;
      }
      
      .form-group {
        margin-bottom: 12px;
      }
      
      .counter-container {
        margin-bottom: 15px;
        padding: 10px;
      }
      
      .btn-container {
        margin-top: 15px;
      }
      
      input {
        padding: 10px 15px 10px 40px;
        min-height: 45px;
      }
      
      button {
        padding: 12px;
        min-height: 45px;
      }
    }
    
    /* Extra Small Phones */
    @media (max-width: 360px) {
      .card {
        padding: 15px;
        border-radius: 16px;
      }
      
      h1 {
        font-size: 20px;
      }
      
      .counter-value {
        font-size: 28px;
      }
      
      input {
        font-size: 14px;
        padding-left: 40px;
      }
      
      .input-icon {
        left: 12px;
      }
    }
    
    /* Tablet Landscape */
    @media (min-width: 768px) and (max-width: 1023px) and (orientation: landscape) {
      .card {
        max-width: 90%;
        margin: 20px auto;
      }
    }
    
    /* Prevent text size adjustment on orientation change */
    @media (orientation: portrait) {
      html {
        -webkit-text-size-adjust: 100%;
      }
    }
    
    /* High Resolution Screens */
    @media (min-resolution: 192dpi) {
      .card {
        border-width: 1.5px;
      }
    }
    
    /* Print Styles */
    @media print {
      body {
        background: white;
        color: black;
      }
      
      .card {
        border: 1px solid #ccc;
        box-shadow: none;
        background: white;
      }
      
      button, .counter-badge, .wheel-bg, .bg-particle {
        display: none !important;
      }
    }
  </style>
</head>
<body>
  <!-- Background Elements -->
  <div class="wheel-bg"></div>
  <div class="wheel-bg"></div>
  
  <!-- Main Card -->
  <div class="card">
    <div class="header">
      <div class="title-icon">
        <i class="fas fa-gem"></i>
      </div>
      <h1>Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ÙÙŠ Ø¹Ø¬Ù„Ø© Ø§Ù„Ø­Ø¸</h1>
      <p class="subtitle">Ø³Ø¬Ù„ Ø§Ù„Ø¢Ù† ÙˆØ§Ø±Ø¨Ø­ Ø¬ÙˆØ§Ø¦Ø² Ù‚ÙŠÙ…Ø© ÙÙŠ Ø³Ø­Ø¨ Ø¹Ø¬Ù„Ø© Ø§Ù„Ø­Ø¸</p>
    </div>
    
    <div class="counter-container">
      <div class="counter-label">Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ† Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†</div>
      <div class="counter-value" id="count">0</div>
      <div class="counter-badge">ğŸ¯ ÙƒÙ† ÙˆØ§Ø­Ø¯Ø§Ù‹ Ù…Ù†Ù‡Ù…!</div>
    </div>
    
    <div class="form-group">
      <label for="roblox"><i class="fas fa-user"></i> Ø§Ø³Ù… Roblox</label>
      <div class="input-container">
        <div class="input-icon"><i class="fab fa-roblox"></i></div>
        <input id="roblox" type="text" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ ÙÙŠ Roblox" autocomplete="off">
      </div>
    </div>
    
    <div class="form-group">
      <label for="whatsapp"><i class="fab fa-whatsapp"></i> Ø±Ù‚Ù… ÙˆØ§ØªØ³Ø§Ø¨</label>
      <div class="input-container">
        <div class="input-icon"><i class="fas fa-phone"></i></div>
        <input id="whatsapp" type="tel" placeholder="01xxxxxxxxx" autocomplete="off">
      </div>
    </div>
    
    <div class="btn-container">
      <button id="register">
        <span class="btn-glow"></span>
        <i class="fas fa-paper-plane"></i> 
        <span>Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ÙÙŠ Ø§Ù„Ø¹Ø¬Ù„Ø©</span>
      </button>
    </div>
    
    <div class="message" id="msg"></div>
    
    <div class="footer">
      <p>Â© 2023 Ø¹Ø¬Ù„Ø© Ø§Ù„Ø­Ø¸ | Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©</p>
      <p>Ø³ÙŠØªÙ… Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø¹Ù† Ø§Ù„ÙØ§Ø¦Ø²ÙŠÙ† Ø¹Ø¨Ø± Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨</p>
    </div>
  </div>

<script>
  // ğŸ”¹ Firebase Config
  const firebaseConfig = {
    apiKey: "AIzaSyBoPJbx5v6EkOqxOJkbhzHqIJdAByh79Rg",
    authDomain: "hhhhhh-d4fb8.firebaseapp.com",
    databaseURL: "https://hhhhhh-d4fb8-default-rtdb.firebaseio.com",
    projectId: "hhhhhh-d4fb8",
    storageBucket: "hhhhhh-d4fb8.appspot.com",
    messagingSenderId: "24512338206",
    appId: "1:24512338206:web:dfe045db59bd3434a2110f",
    measurementId: "G-HD4R7GNQ5H"
  };

  // ğŸ”¹ Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  // ğŸ”¹ DOM Elements
  const countEl = document.getElementById('count');
  const msgEl = document.getElementById('msg');
  const btn = document.getElementById('register');
  const robloxInput = document.getElementById('roblox');
  const whatsappInput = document.getElementById('whatsapp');

  // ğŸ”¹ Responsive Helper Functions
  function adjustForScreenSize() {
    const width = window.innerWidth;
    const height = window.innerHeight;
    const isMobile = width <= 480;
    const isTablet = width > 480 && width <= 768;
    const isLandscape = width > height;
    
    // Adjust body padding based on screen size
    if (isMobile && isLandscape) {
      document.body.style.padding = '5px';
    } else if (isMobile) {
      document.body.style.padding = '12px';
    } else if (isTablet) {
      document.body.style.padding = '20px';
    } else {
      document.body.style.padding = '20px';
    }
  }

  // ğŸ”¹ Create Background Particles
  function createParticles() {
    const particlesContainer = document.body;
    const particleCount = window.innerWidth < 768 ? 15 : 25;
    
    for (let i = 0; i < particleCount; i++) {
      const particle = document.createElement('div');
      particle.classList.add('bg-particle');
      
      const size = window.innerWidth < 768 ? 
        Math.random() * 8 + 3 : 
        Math.random() * 10 + 5;
      
      particle.style.width = `${size}px`;
      particle.style.height = `${size}px`;
      
      particle.style.left = `${Math.random() * 100}vw`;
      particle.style.top = `${Math.random() * 100}vh`;
      
      particle.style.background = i % 3 === 0 
        ? 'rgba(255, 43, 43, 0.15)' 
        : i % 3 === 1 
          ? 'rgba(0, 201, 255, 0.15)' 
          : 'rgba(255, 215, 0, 0.15)';
      
      particlesContainer.appendChild(particle);
      
      // Animate particle
      animateParticle(particle);
    }
  }
  
  function animateParticle(particle) {
    let x = parseFloat(particle.style.left);
    let y = parseFloat(particle.style.top);
    let xSpeed = (Math.random() - 0.5) * (window.innerWidth < 768 ? 0.3 : 0.5);
    let ySpeed = (Math.random() - 0.5) * (window.innerWidth < 768 ? 0.3 : 0.5);
    
    function move() {
      x += xSpeed;
      y += ySpeed;
      
      if (x > 100 || x < 0) xSpeed *= -1;
      if (y > 100 || y < 0) ySpeed *= -1;
      
      particle.style.left = `${x}vw`;
      particle.style.top = `${y}vh`;
      
      requestAnimationFrame(move);
    }
    
    move();
  }

  // ğŸ”¹ Animate Counter
  function animateCounter(element, targetValue) {
    const currentValue = parseInt(element.textContent.replace(/,/g, '')) || 0;
    const duration = 800;
    const steps = 20;
    const stepValue = (targetValue - currentValue) / steps;
    let currentStep = 0;
    
    const counter = setInterval(() => {
      currentStep++;
      const newValue = Math.round(currentValue + (stepValue * currentStep));
      element.textContent = newValue.toLocaleString('ar-EG');
      
      // Add pulse animation on each step
      element.style.transform = 'scale(1.1)';
      setTimeout(() => {
        element.style.transform = 'scale(1)';
      }, 50);
      
      if (currentStep >= steps) {
        clearInterval(counter);
        element.textContent = targetValue.toLocaleString('ar-EG');
      }
    }, duration / steps);
  }

  // ğŸ”¹ Show Message
  function showMessage(text, type) {
    msgEl.textContent = text;
    msgEl.className = `message show ${type}`;
    
    let icon = '';
    if (type === 'success') icon = '<i class="fas fa-check-circle"></i>';
    else if (type === 'warning') icon = '<i class="fas fa-exclamation-triangle"></i>';
    else if (type === 'error') icon = '<i class="fas fa-times-circle"></i>';
    
    msgEl.innerHTML = `${icon} <span>${text}</span>`;
    
    if (type !== 'success') {
      setTimeout(() => {
        msgEl.classList.remove('show');
      }, 5000);
    }
  }

  // ğŸ”¹ Get IP Address
  async function getIP() {
    try {
      const res = await fetch('https://api.ipify.org?format=json');
      const data = await res.json();
      return data.ip;
    } catch (error) {
      console.error('Error getting IP:', error);
      return 'unknown';
    }
  }

  // ğŸ”¹ Validate Inputs
  function validateInputs(roblox, whatsapp) {
    if (!roblox || !whatsapp) {
      showMessage('Ø¨Ø±Ø¬Ø§Ø¡ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'error');
      return false;
    }
    
    if (roblox.length < 3 || roblox.length > 20) {
      showMessage('Ø§Ø³Ù… Roblox ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø¨ÙŠÙ† 3 Ùˆ 20 Ø­Ø±Ù', 'error');
      return false;
    }
    
    const whatsappRegex = /^01[0-9]{9}$/;
    if (!whatsappRegex.test(whatsapp)) {
      showMessage('Ø±Ù‚Ù… ÙˆØ§ØªØ³Ø§Ø¨ ØºÙŠØ± ØµØ­ÙŠØ­. ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ¨Ø¯Ø£ Ø¨Ù€ 01 ÙˆÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ 11 Ø±Ù‚Ù…', 'error');
      return false;
    }
    
    return true;
  }

  // ğŸ”¹ Initialize Page
  document.addEventListener('DOMContentLoaded', () => {
    // Adjust for initial screen size
    adjustForScreenSize();
    
    // Create background particles
    createParticles();
    
    // Focus on first input
    robloxInput.focus();
    
    // Adjust input font size for mobile to prevent zoom
    if (window.innerWidth <= 480) {
      robloxInput.style.fontSize = '16px';
      whatsappInput.style.fontSize = '16px';
    }
  });

  // ğŸ”¹ Handle Window Resize
  let resizeTimer;
  window.addEventListener('resize', () => {
    clearTimeout(resizeTimer);
    resizeTimer = setTimeout(() => {
      adjustForScreenSize();
    }, 250);
  });

  // ğŸ”¹ Handle Orientation Change
  window.addEventListener('orientationchange', () => {
    setTimeout(adjustForScreenSize, 100);
  });

  // ğŸ”¹ Real-time Counter Update
  db.ref('wheel_users').on('value', snap => {
    const count = snap.exists() ? snap.numChildren() : 0;
    animateCounter(countEl, count);
  });

  // ğŸ”¹ Register Button Click
  btn.onclick = async () => {
    const roblox = robloxInput.value.trim();
    const whatsapp = whatsappInput.value.trim();
    
    if (!validateInputs(roblox, whatsapp)) return;
    
    btn.disabled = true;
    btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i><span>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ³Ø¬ÙŠÙ„...</span>';
    
    try {
      const ip = await getIP();
      
      // Check if IP already registered
      const ipRef = db.ref('ips/' + ip.replace(/\./g, '_'));
      const ipSnap = await ipRef.get();
      
      if (ipSnap.exists()) {
        showMessage('ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ù…Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¬Ù‡Ø§Ø² Ù…Ù† Ù‚Ø¨Ù„', 'warning');
        btn.disabled = false;
        btn.innerHTML = '<i class="fas fa-paper-plane"></i><span>Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ÙÙŠ Ø§Ù„Ø¹Ø¬Ù„Ø©</span>';
        return;
      }
      
      // Save user data
      const userRef = db.ref('wheel_users').push();
      await userRef.set({
        roblox,
        whatsapp,
        ip,
        time: Date.now(),
        timestamp: new Date().toLocaleString('ar-EG')
      });
      
      // Mark IP as used
      await ipRef.set(true);
      
      // Success
      showMessage('ØªÙ… ØªØ³Ø¬ÙŠÙ„Ùƒ Ø¨Ù†Ø¬Ø§Ø­ ÙÙŠ Ø¹Ø¬Ù„Ø© Ø§Ù„Ø­Ø¸! Ø³ÙŠØªÙ… Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ùƒ Ø¹Ø¨Ø± Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ Ø¥Ø°Ø§ ÙØ²Øª', 'success');
      
      // Reset form
      robloxInput.value = '';
      whatsappInput.value = '';
      
      // Add celebration effect
      const titleIcon = document.querySelector('.title-icon');
      titleIcon.style.animation = 'none';
      setTimeout(() => {
        titleIcon.style.animation = 'pulse 0.5s 3';
      }, 10);
      
      // Keep button disabled with success message
      btn.innerHTML = '<i class="fas fa-check"></i><span>ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­!</span>';
      
    } catch (error) {
      console.error('Registration error:', error);
      showMessage('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ³Ø¬ÙŠÙ„. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰', 'error');
      btn.disabled = false;
      btn.innerHTML = '<i class="fas fa-paper-plane"></i><span>Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ÙÙŠ Ø§Ù„Ø¹Ø¬Ù„Ø©</span>';
    }
  };

  // ğŸ”¹ Enter Key Support
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Enter') {
      btn.click();
    }
  });

  // ğŸ”¹ Touch Device Improvements
  document.addEventListener('touchstart', () => {}, {passive: true});
</script>
</body>
</html>
